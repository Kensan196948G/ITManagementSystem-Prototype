#!/bin/bash
# ===================================
# ITSM тЁесѓхсЃ╝сЃЊсѓ╣УхитІЋсѓ╣сѓ»сЃфсЃЌсЃѕ
# ===================================

echo "=========================================="
echo "IT Management System - Full Startup"
echo "=========================================="

# сѓ╣сѓ»сЃфсЃЌсЃѕсЂ«сЃЄсѓБсЃгсѓ»сЃѕсЃфсЂФуД╗тІЋ
cd "$(dirname "$0")"

# .envсЃЋсѓАсѓцсЃФсЂ«уб║УфЇ
if [ ! -f ".env" ]; then
    echo "­ЪЊЮ .envсЃЋсѓАсѓцсЃФсѓњСйюТѕљсЂЌсЂдсЂёсЂЙсЂЎ..."
    cp .env.example .env
    echo "Рџа№ИЈ  .envсЃЋсѓАсѓцсЃФсѓњт┐ЁУдЂсЂФт┐юсЂўсЂдуиежЏєсЂЌсЂдсЂЈсЂасЂЋсЂё"
fi

# сЃљсЃЃсѓ»сѓесЃ│сЃЅсѓњтѕЦсѓ┐сЃ╝сЃЪсЃісЃФсЂДУхитІЋ
echo "­ЪћД сЃљсЃЃсѓ»сѓесЃ│сЃЅсѓхсЃ╝сЃљсЃ╝сѓњУхитІЋсЂЌсЂдсЂёсЂЙсЂЎ..."
gnome-terminal --tab --title="ITSM Backend" -- bash -c "./start-backend.sh; exec bash" 2>/dev/null || \
xterm -title "ITSM Backend" -e "./start-backend.sh" 2>/dev/null || \
(./start-backend.sh &)

# т░ЉсЂЌтЙЁсЂц
sleep 3

# сЃЋсЃГсЃ│сЃѕсѓесЃ│сЃЅсѓњУхитІЋ
echo "­Ъје сЃЋсЃГсЃ│сЃѕсѓесЃ│сЃЅсѓхсЃ╝сЃљсЃ╝сѓњУхитІЋсЂЌсЂдсЂёсЂЙсЂЎ..."
echo ""
npm install
npm run dev

echo ""
echo "=========================================="
echo "РюЁ тЁесѓхсЃ╝сЃЊсѓ╣сЂїУхитІЋсЂЌсЂЙсЂЌсЂЪ"
echo "сЃЋсЃГсЃ│сЃѕсѓесЃ│сЃЅ: http://localhost:5173"
echo "сЃљсЃЃсѓ»сѓесЃ│сЃЅ: http://localhost:8000"
echo "=========================================="