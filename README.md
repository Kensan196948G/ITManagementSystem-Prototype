# ITサービス管理システム (ITSM)

## 概要
このシステムは、ISO 20000・ISO 27001・ISO 27002に準拠したITサービス管理システムです。建設土木会社のIT部門向けに、ITサービスおよびシステムの運用を標準化し、効率的な管理を実現するためのプラットフォームを提供します。

## 目的
- IT部門（5名）の運用負担を軽減
- 業務の自動化率を向上（定型業務の80%以上）
- セキュリティ対策の強化（ISO 27001/27002準拠）
- システム可用性の向上
- データ分析に基づく意思決定の支援

## システム構成
このプロジェクトはモノレポ構成を採用しており、npm ワークスペースを使用して複数のパッケージを管理しています。各パッケージは `packages/` ディレクトリ配下に配置されています。

### パッケージ
- `packages/frontend`: フロントエンドアプリケーション (React.js, Tailwind CSS, Axios)
- `packages/backend`: バックエンドAPI (Python/Flask, PowerShell, SQLite)
- `packages/eslint-config`: 共有 ESLint 設定

## 主要機能
1. システム運用管理自動化（監視・アラート・基本的トラブルシューティング）
2. **高度なレポーティング機能**
   - 日次/週次/月次レポート自動生成
   - WEB UI上でのリアルタイム表示
   - メール配信機能
   - カスタマイズ可能なレポート内容
3. ワークフロー管理（チケット・タスク・承認フロー）
4. データ分析（統計・トレンド分析）
5. セキュリティ管理（アクセス管理・監査）
6. APIパーミッション管理（Microsoft 365）

## 認証について
システムは標準的なユーザー名/パスワード認証を使用しています。以前実装されていたMicrosoft Entra ID（旧Azure AD）認証は廃止されました。

### テスト用アカウント
開発環境では、以下のテストユーザーが利用可能です:
| ユーザー名 | パスワード | 権限 |
|------------|------------|------|
| admin      | admin      | グローバル管理者 |
| user       | user       | 一般ユーザー |
| guest      | guest      | ゲスト |

## レポート機能
システムには以下のレポート機能が実装されています:

### レポートタイプ
- **システム概要**: システム全体の状態と主要指標の概要
- **インシデント概要**: 発生したインシデントとその対応状況
- **ユーザーアクティビティ**: ユーザーのシステム利用状況
- **セキュリティイベント**: セキュリティ関連のイベントと分析
- **パフォーマンス指標**: システムパフォーマンスの詳細分析
- **ユーザーログイン状況**: ユーザーアカウントの変更（追加/削除/ロール変更）および詳細なログイン/ログアウト時刻履歴

### レポート配信
- UI上でのリアルタイム表示
- メールでの自動配信（設定ページで構成可能）
- PDF形式でのエクスポート

## インストール方法
```bash
# クローン
git clone https://github.com/yourusername/ITManagementSystem.git

# プロジェクトルートに移動
cd ITManagementSystem-Prototype

# 依存関係のインストール (npm ワークスペースが使用されます)
npm install

# プロジェクトの実行
# フロントエンドとバックエンドを同時に起動します
npm start

# または各パッケージを個別に実行
# フロントエンド
npm start --workspace=frontend

# バックエンド
npm start --workspace=backend
```

## 開発者向け情報
- コーディング規約：PEP8（Python）、StandardJS（JavaScript）
- バージョン管理：Git/GitHub
- CI/CD：GitHub Actions

## 変更履歴
### 2025/05/17
- プロジェクトをモノレポ構成に移行し、npm ワークスペースを導入
- `frontend/` および `backend/` ディレクトリを `packages/` ディレクトリ配下に移動
- 共通依存関係をルートの `package.json` に集約
- `eslint-plugin-owasp-recommended` の依存関係を削除

### 2025/03/17
- Microsoft認証（Azure AD認証）を廃止し、標準的なユーザー名/パスワード認証に統一
- 新しいレポート機能を追加（日次/週次/月次レポート、メール配信）
- レポート設定画面の刷新

## ライセンス
このプロジェクトは企業内部利用を目的としており、プロプライエタリライセンスの下で管理されています。無断での複製・配布・改変は禁止されています。
## バックエンドのテスト環境構築と実行方法

### 1. Python仮想環境の作成と有効化

```bash
# プロジェクトルートで仮想環境を作成
python -m venv .venv

# Windows PowerShellの場合（仮想環境の有効化）
.\.venv\Scripts\Activate.ps1

# Windows コマンドプロンプトの場合（仮想環境の有効化）
.\.venv\Scripts\activate.bat
```

### 2. 必要なパッケージのインストール

```bash
# 仮想環境有効化後に以下を実行
pip install -r requirements.txt
```

### 3. pytest-covの導入

`requirements.txt` に以下を追加してください。

```
pytest
pytest-cov
```

### 4. テストの実行とカバレッジ確認

```bash
# 仮想環境有効化後に以下を実行
pytest --cov=backend --cov-report=term-missing --cov-report=html
```

- `--cov=backend` はカバレッジ計測対象のディレクトリを指定しています。
- `--cov-report=term-missing` はカバレッジの不足箇所をターミナルに表示します。
- `--cov-report=html` はHTML形式のカバレッジレポートを生成します。

生成されたHTMLレポートは `htmlcov/index.html` で確認可能です。

---
