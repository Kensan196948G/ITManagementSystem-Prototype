# 本番環境移行チェックリスト

## 移行前準備

### インフラストラクチャ準備
- [ ] Azureリソースグループの作成
- [ ] Azureサブスクリプションの有効性確認
- [ ] リソース制限の確認
- [ ] ネットワーク設定の完了
  - [ ] 仮想ネットワーク
  - [ ] サブネット
  - [ ] NSG（ネットワークセキュリティグループ）
- [ ] ドメイン名の準備と設定

### セキュリティ準備
- [ ] SSL証明書の取得と設定
- [ ] Azure ADアプリケーション登録
- [ ] シークレット管理（Key Vault）の設定
- [ ] ファイアウォールルールの設定
- [ ] WAF（Webアプリケーションファイアウォール）の設定

### データベース準備
- [ ] Azure SQL Databaseのプロビジョニング
- [ ] データベースファイアウォール設定
- [ ] バックアップ設定
- [ ] 高可用性設定の確認

## デプロイ手順

### ステージング環境デプロイ
- [ ] ステージング環境の構築
- [ ] フロントエンドのデプロイ
- [ ] バックエンドのデプロイ
- [ ] データベース移行
- [ ] 統合テスト実施

### 本番環境デプロイ
- [ ] メンテナンスモード通知の送信
- [ ] データベースのバックアップ作成
- [ ] データベース移行スクリプトの実行
- [ ] バックエンドのデプロイ
- [ ] フロントエンドのデプロイ
- [ ] DNS設定の更新

## デプロイ後の検証

### 機能検証
- [ ] ログイン認証フローの確認
- [ ] 主要ページの表示確認
- [ ] API機能の動作確認
- [ ] レポート生成機能の確認
- [ ] ファイルアップロード/ダウンロード機能の確認

### パフォーマンス検証
- [ ] ページ読み込み時間の測定（目標: < 2秒）
- [ ] API応答時間の測定（目標: < 500ms）
- [ ] データベースクエリパフォーマンスの確認
- [ ] 同時ユーザー負荷テスト（目標: 100ユーザー同時接続）

### セキュリティ検証
- [ ] HTTPS接続の確認
- [ ] CSPヘッダーの確認
- [ ] XSS保護の確認
- [ ] CSRF保護の確認
- [ ] 認証・認可フローの検証

## モニタリングとアラート設定

### モニタリング設定
- [ ] Prometheusのデプロイと設定
- [ ] Grafanaダッシュボードの設定
- [ ] Lokiによるログ集約設定
- [ ] Azure Monitor連携設定
- [ ] カスタムメトリクスの設定

### アラート設定
- [ ] システム障害アラートの設定
- [ ] パフォーマンス低下アラートの設定
- [ ] セキュリティイベントアラートの設定
- [ ] ビジネスメトリクスアラートの設定
- [ ] アラート通知先の設定（Slack/Teams）

## 運用開始

### 運用ドキュメント
- [ ] 運用手順書の作成
- [ ] 障害対応フローの作成
- [ ] バックアップ/リストア手順の作成
- [ ] メンテナンス手順の作成

### 運用チーム準備
- [ ] 運用チームへの引き継ぎ
- [ ] トレーニングの実施
- [ ] 監視ダッシュボードへのアクセス権付与
- [ ] エスカレーションフローの確認

### 最終確認
- [ ] すべての機能が正常に動作していることの確認
- [ ] すべてのモニタリングが正常に機能していることの確認
- [ ] すべてのアラートが正しく設定されていることの確認
- [ ] ドキュメントが完成していることの確認

## ロールバック計画

### ロールバックトリガー
- 複数の重大なバグが発見された場合
- システムパフォーマンスが著しく低下した場合
- セキュリティ上の脆弱性が発見された場合

### ロールバック手順
- [ ] ロールバック決定からの連絡フロー
- [ ] メンテナンスモードへの切り替え
- [ ] データベースのロールバック
- [ ] アプリケーションのロールバック
- [ ] ロールバック完了の確認と通知