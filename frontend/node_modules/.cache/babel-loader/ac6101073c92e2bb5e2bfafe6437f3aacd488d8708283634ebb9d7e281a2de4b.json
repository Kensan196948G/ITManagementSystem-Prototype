{"ast":null,"code":"import React,{useState,useRef,useEffect}from'react';import{useNavigate}from'react-router-dom';import{useAuth}from'../../contexts/AuthContext';import{Bars3Icon,BellIcon,UserCircleIcon}from'@heroicons/react/24/outline';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const Header=_ref=>{let{toggleSidebar}=_ref;const{currentUser,logout}=useAuth();const navigate=useNavigate();const[menuOpen,setMenuOpen]=useState(false);const menuRef=useRef(null);// メニュー外をクリックした時に閉じる処理\nuseEffect(()=>{function handleClickOutside(event){if(menuRef.current&&!menuRef.current.contains(event.target)){setMenuOpen(false);}}if(menuOpen){document.addEventListener('mousedown',handleClickOutside);}return()=>{document.removeEventListener('mousedown',handleClickOutside);};},[menuOpen]);const handleLogout=()=>{logout();navigate('/login');setMenuOpen(false);};return/*#__PURE__*/_jsx(\"header\",{className:\"bg-white shadow-sm z-10\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between px-4 py-3\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:toggleSidebar,className:\"p-2 rounded-md text-secondary-500 hover:bg-secondary-100 focus:outline-none\",children:/*#__PURE__*/_jsx(Bars3Icon,{className:\"h-6 w-6\"})}),/*#__PURE__*/_jsx(\"h1\",{className:\"ml-4 text-lg font-semibold text-secondary-900\",children:\"IT\\u30B5\\u30FC\\u30D3\\u30B9\\u7BA1\\u7406\\u30B7\\u30B9\\u30C6\\u30E0\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-4\",children:[/*#__PURE__*/_jsxs(\"button\",{className:\"relative p-2 rounded-full text-secondary-500 hover:bg-secondary-100 focus:outline-none\",children:[/*#__PURE__*/_jsx(BellIcon,{className:\"h-6 w-6\"}),/*#__PURE__*/_jsx(\"span\",{className:\"absolute top-0 right-0 block h-2 w-2 rounded-full bg-danger-500 ring-2 ring-white\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"relative\",ref:menuRef,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-2 cursor-pointer\",onClick:()=>setMenuOpen(!menuOpen),children:[/*#__PURE__*/_jsx(UserCircleIcon,{className:\"h-8 w-8 text-secondary-500\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"hidden md:block\",children:[currentUser&&/*#__PURE__*/_jsx(\"p\",{className:\"text-sm font-medium text-secondary-900\",children:localStorage.getItem('userRole')==='msuser'&&currentUser.microsoftInfo?// Microsoftログインの場合は表示名を使用\ncurrentUser.microsoftInfo.displayName||`${currentUser.first_name} ${currentUser.last_name}`:// 通常ログインの場合は名前を表示\n`${currentUser.first_name} ${currentUser.last_name}`}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-secondary-700\",children:/*#__PURE__*/_jsx(\"span\",{className:\"font-medium\",children:currentUser===null||currentUser===void 0?void 0:currentUser.role})}),currentUser&&/*#__PURE__*/_jsx(\"p\",{className:\"mt-0.5\",children:localStorage.getItem('userRole')==='msuser'&&currentUser.microsoftInfo?/*#__PURE__*/// Microsoft Entra IDユーザーの場合\n_jsxs(\"span\",{className:\"px-2 py-0.5 bg-blue-100 text-blue-800 rounded text-xs font-medium\",children:[/*#__PURE__*/_jsx(\"svg\",{xmlns:\"http://www.w3.org/2000/svg\",className:\"inline-block h-3 w-3 mr-1\",viewBox:\"0 0 16 16\",fill:\"currentColor\",children:/*#__PURE__*/_jsx(\"path\",{d:\"M0 0h7.5v7.5H0V0zm8.5 0H16v7.5H8.5V0zM0 8.5h7.5V16H0V8.5zm8.5 0H16V16H8.5V8.5z\"})}),currentUser.microsoftInfo.accountType||'Microsoft Entra ID']}):/*#__PURE__*/// 通常ユーザーの場合（admin/user/guest）\n_jsx(\"span\",{className:\"px-2 py-0.5 bg-blue-100 text-blue-800 rounded text-xs font-medium\",children:currentUser.id==='1'?'admin':currentUser.id==='2'?'user':currentUser.id==='3'?'guest':'不明'})})]})]}),menuOpen&&/*#__PURE__*/_jsxs(\"div\",{className:\"absolute right-0 mt-2 w-48 rounded-md shadow-lg py-1 bg-white ring-1 ring-black ring-opacity-5 z-20\",children:[/*#__PURE__*/_jsx(\"a\",{href:\"#profile\",className:\"block px-4 py-2 text-sm text-secondary-700 hover:bg-secondary-100\",onClick:()=>setMenuOpen(false),children:\"\\u30D7\\u30ED\\u30D5\\u30A3\\u30FC\\u30EB\"}),/*#__PURE__*/_jsx(\"a\",{href:\"#settings\",className:\"block px-4 py-2 text-sm text-secondary-700 hover:bg-secondary-100\",onClick:()=>setMenuOpen(false),children:\"\\u8A2D\\u5B9A\"}),/*#__PURE__*/_jsx(\"button\",{onClick:handleLogout,className:\"block w-full text-left px-4 py-2 text-sm text-secondary-700 hover:bg-secondary-100\",children:\"\\u30ED\\u30B0\\u30A2\\u30A6\\u30C8\"})]})]})]})]})});};export default Header;","map":{"version":3,"names":["React","useState","useRef","useEffect","useNavigate","useAuth","Bars3Icon","BellIcon","UserCircleIcon","jsx","_jsx","jsxs","_jsxs","Header","_ref","toggleSidebar","currentUser","logout","navigate","menuOpen","setMenuOpen","menuRef","handleClickOutside","event","current","contains","target","document","addEventListener","removeEventListener","handleLogout","className","children","onClick","ref","localStorage","getItem","microsoftInfo","displayName","first_name","last_name","role","xmlns","viewBox","fill","d","accountType","id","href"],"sources":["F:/kitting/ITManagementSystem/frontend/src/components/layout/Header.js"],"sourcesContent":["import React, { useState, useRef, useEffect } from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { useAuth } from '../../contexts/AuthContext';\r\nimport { Bars3Icon, BellIcon, UserCircleIcon } from '@heroicons/react/24/outline';\r\n\r\nconst Header = ({ toggleSidebar }) => {\r\n  const { currentUser, logout } = useAuth();\r\n  const navigate = useNavigate();\r\n  const [menuOpen, setMenuOpen] = useState(false);\r\n  const menuRef = useRef(null);\r\n\r\n  // メニュー外をクリックした時に閉じる処理\r\n  useEffect(() => {\r\n    function handleClickOutside(event) {\r\n      if (menuRef.current && !menuRef.current.contains(event.target)) {\r\n        setMenuOpen(false);\r\n      }\r\n    }\r\n\r\n    if (menuOpen) {\r\n      document.addEventListener('mousedown', handleClickOutside);\r\n    }\r\n    return () => {\r\n      document.removeEventListener('mousedown', handleClickOutside);\r\n    };\r\n  }, [menuOpen]);\r\n\r\n  const handleLogout = () => {\r\n    logout();\r\n    navigate('/login');\r\n    setMenuOpen(false);\r\n  };\r\n\r\n  return (\r\n    <header className=\"bg-white shadow-sm z-10\">\r\n      <div className=\"flex items-center justify-between px-4 py-3\">\r\n        <div className=\"flex items-center\">\r\n          <button\r\n            onClick={toggleSidebar}\r\n            className=\"p-2 rounded-md text-secondary-500 hover:bg-secondary-100 focus:outline-none\"\r\n          >\r\n            <Bars3Icon className=\"h-6 w-6\" />\r\n          </button>\r\n          <h1 className=\"ml-4 text-lg font-semibold text-secondary-900\">ITサービス管理システム</h1>\r\n        </div>\r\n\r\n        <div className=\"flex items-center space-x-4\">\r\n          {/* 通知ボタン */}\r\n          <button className=\"relative p-2 rounded-full text-secondary-500 hover:bg-secondary-100 focus:outline-none\">\r\n            <BellIcon className=\"h-6 w-6\" />\r\n            <span className=\"absolute top-0 right-0 block h-2 w-2 rounded-full bg-danger-500 ring-2 ring-white\"></span>\r\n          </button>\r\n\r\n          {/* ユーザーメニュー */}\r\n          <div className=\"relative\" ref={menuRef}>\r\n            <div \r\n              className=\"flex items-center space-x-2 cursor-pointer\"\r\n              onClick={() => setMenuOpen(!menuOpen)}\r\n            >\r\n              <UserCircleIcon className=\"h-8 w-8 text-secondary-500\" />\r\n              <div className=\"hidden md:block\">\r\n                {/* ユーザー名の表示 */}\r\n                {currentUser && (\r\n                  <p className=\"text-sm font-medium text-secondary-900\">\r\n                    {localStorage.getItem('userRole') === 'msuser' && currentUser.microsoftInfo ? (\r\n                      // Microsoftログインの場合は表示名を使用\r\n                      currentUser.microsoftInfo.displayName || `${currentUser.first_name} ${currentUser.last_name}`\r\n                    ) : (\r\n                      // 通常ログインの場合は名前を表示\r\n                      `${currentUser.first_name} ${currentUser.last_name}`\r\n                    )}\r\n                  </p>\r\n                )}\r\n                \r\n                {/* ユーザーロールの表示 */}\r\n                <p className=\"text-xs text-secondary-700\">\r\n                  <span className=\"font-medium\">{currentUser?.role}</span>\r\n                </p>\r\n                \r\n                {/* アカウントタイプのバッジ表示 */}\r\n                {currentUser && (\r\n                  <p className=\"mt-0.5\">\r\n                    {localStorage.getItem('userRole') === 'msuser' && currentUser.microsoftInfo ? (\r\n                      // Microsoft Entra IDユーザーの場合\r\n                      <span className=\"px-2 py-0.5 bg-blue-100 text-blue-800 rounded text-xs font-medium\">\r\n                        <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"inline-block h-3 w-3 mr-1\" viewBox=\"0 0 16 16\" fill=\"currentColor\">\r\n                          <path d=\"M0 0h7.5v7.5H0V0zm8.5 0H16v7.5H8.5V0zM0 8.5h7.5V16H0V8.5zm8.5 0H16V16H8.5V8.5z\"/>\r\n                        </svg>\r\n                        {currentUser.microsoftInfo.accountType || 'Microsoft Entra ID'}\r\n                      </span>\r\n                    ) : (\r\n                      // 通常ユーザーの場合（admin/user/guest）\r\n                      <span className=\"px-2 py-0.5 bg-blue-100 text-blue-800 rounded text-xs font-medium\">\r\n                        {currentUser.id === '1' ? 'admin' : \r\n                         currentUser.id === '2' ? 'user' : \r\n                         currentUser.id === '3' ? 'guest' : '不明'}\r\n                      </span>\r\n                    )}\r\n                  </p>\r\n                )}\r\n              </div>\r\n            </div>\r\n\r\n            {/* 簡易ドロップダウンメニュー (クリックして表示) */}\r\n            {menuOpen && (\r\n              <div className=\"absolute right-0 mt-2 w-48 rounded-md shadow-lg py-1 bg-white ring-1 ring-black ring-opacity-5 z-20\">\r\n                <a \r\n                  href=\"#profile\" \r\n                  className=\"block px-4 py-2 text-sm text-secondary-700 hover:bg-secondary-100\"\r\n                  onClick={() => setMenuOpen(false)}\r\n                >\r\n                  プロフィール\r\n                </a>\r\n                <a \r\n                  href=\"#settings\" \r\n                  className=\"block px-4 py-2 text-sm text-secondary-700 hover:bg-secondary-100\"\r\n                  onClick={() => setMenuOpen(false)}\r\n                >\r\n                  設定\r\n                </a>\r\n                <button\r\n                  onClick={handleLogout}\r\n                  className=\"block w-full text-left px-4 py-2 text-sm text-secondary-700 hover:bg-secondary-100\"\r\n                >\r\n                  ログアウト\r\n                </button>\r\n              </div>\r\n            )}\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </header>\r\n  );\r\n};\r\n\r\nexport default Header;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}